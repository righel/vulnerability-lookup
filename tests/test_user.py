from sqlalchemy.engine.base import Engine
from werkzeug.security import generate_password_hash

from website.models.user import User


def test_user(session: Engine) -> None:
    user = User(
        login="john",
        name="John Doe",
        pwdhash=generate_password_hash("password"),
        email="john@doe.example",
        last_seen=None,
    )

    session.add(user)  # type: ignore[attr-defined]
    session.commit()  # type: ignore[attr-defined]

    assert user.is_admin is False
    assert user.is_active is True
    assert user.is_confirmed is False
    assert user.check_password("password") is True
    assert user.apikey != ""
