APP_NAME = "Vulnerability Lookup" # Mandatory for the QRCode of the 2FA

# Set it to True to run flask in debug mode. **do not do that in prod**
DEBUG = False

BOOTSTRAP_SERVE_LOCAL =  True
SESSION_COOKIE_NAME = "vulnerability-lookup"

CSRF_ENABLED = True
SESSION_COOKIE_SAMESITE = "Strict"

# #### Database ####
DB_CONFIG_DICT = {
    "user": "postgres",
    "password": "password",
    "host": "127.0.0.1",
    "port": 5432,
}
DATABASE_NAME = "vulnlookup"
SQLALCHEMY_DATABASE_URI = "postgresql://{user}:{password}@{host}:{port}/{name}".format(
    name=DATABASE_NAME, **DB_CONFIG_DICT
)
SQLALCHEMY_ENGINE_OPTIONS = {
    'pool_size': 100,           # Number of persistent connections in the pool
    'max_overflow': 50,         # Additional connections for spikes in traffic
    'pool_timeout': 30,         # Wait time for a connection before timeout
    'pool_recycle': 1800,       # Recycle connections every 30 minutes to prevent stale connections
    'pool_pre_ping': True       # Ensures the connection is valid before using
}


# #### Notifications ####
MAIL_SERVER = "localhost"
MAIL_PORT = 25
MAIL_USE_TLS = False
MAIL_USE_SSL = False
MAIL_DEBUG = False
MAIL_USERNAME = None
MAIL_PASSWORD = None
MAIL_DEFAULT_SENDER = "admin@admin.localhost"
TOKEN_VALIDITY_PERIOD = 3600
PLATFORM_URL = "https://vulnerability.circl.lu"


# #### Misc ####
ENFORCE_2FA = True
SELF_REGISTRATION = True
FEED_MAX_PER_PAGE = 50
COMMENTS_MODERATION = True
LOG_LEVEL = "INFO"
LOG_PATH = "logs/website_warning.log"
ADMIN_EMAIL = "info@circl.lu"
ADMIN_NAME = "Computer Incident Response Center Luxembourg (CIRCL)"
ADMIN_WEBSITE = "https://www.circl.lu"

SOURCES_TO_SHOW = {
    "github": "GitHub",
    "cvelistv5": "CVE List v5",
    "nvd": "NVD",
    "pysec": "PySec",
    "gsd": "GSD",
    "ossf_malicious_packages": "OpenSSF Malicious Packages",
    "csaf_certbund": "CSAF CERT-Bund",
    "csaf_ncscnl": "CSAF NCSC NL",
    "csaf_siemens": "CSAF Siemens",
    "csaf_redhat": "CSAF Red Hat",
    "csaf_cisa": "CSAF CISA",
    "csaf_cisco": "CSAF CISCO",
    "csaf_sick": "CSAF Sick",
    "csaf_nozominetworks": "CSAF Nozomi Networks",
    "csaf_ox": "CSAF Open-Xchange",
    "variot": "VARIoT",
    "jvndb": "JVNDB",
    "tailscale": "Tailscale",
    "circl": "CIRCL",
}
